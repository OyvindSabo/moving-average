<script>
  const cryptocurrencyIds = [
    'bitcoin',
    'ethereum',
    'ripple',
    'tether',
    'bitcoin-cash',
    'litecoin',
    'eos',
    'binancecoin',
    'bitcoin-cash-sv',
  ];
  const vsCurrencies = ['usd', 'eur', 'jpy'];
</script>

<script>
  class Store {
    // @containerId: string
    constructor(containerId) {
      this.days = 30;
      this.vsCurrency = 'eur';
      this.id = 'bitcoin';
      this.prices = [];
      this.getPriceHistory();
    }
    // @prices: [timeStamp: UnixTime, price: number][]
    setPrices(prices) {
      this.prices = prices;
      this.render();
    }
    async getPriceHistory() {
      return fetch(
        `https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=${
          this.vsCurrency
        }&days=${Math.max(this.days, 91)}`
      )
        .then(res =>
          res.json().then(res => {
            console.log('res: ', res);
            this.setPrices(res.prices);
          })
        )
        .catch(error => {
          console.log('error: ', error);
        });
    }
    render() {
      //this.container.innerHTML = 'success';
      document.getElementById('current-price').innerHTML = this.prices[
        this.prices.length - 1
      ][1];
    }
  }
</script>

<div id="app-container">
  <span style="display:inline-block;width:100px;">Cryptocurrency</span>
  <select>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="opel">Opel</option>
    <option value="audi">Audi</option> </select
  ><br />
  <span style="display:inline-block;width:100px;">Fiat currency</span>
  <select>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="opel">Opel</option>
    <option value="audi">Audi</option> </select
  ><br />
  <span style="display:inline-block;width:100px;">Current price: </span>
  <span id="current-price"></span>
</div>
<script>
  const store = new Store('app-container');
</script>
